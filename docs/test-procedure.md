# Optimal testing strategy
This document describes how performance tests are run for this project and how these should be documented.
All documented test results must follow this procedure unless explicitly stated otherwise.

## Directory structure
```yaml
docs/
 └─ tests/
     ├─ test-procedure.md               # How tests are run
     ├─ snapshots/                      # Raw test runs
     │   ├─ 2026-02-04-main-vs-packages-run1.md
     │   ├─ 2026-02-04-main-vs-packages-run2.md
     │   ├─ 2026-02-04-main-vs-packages-run3.md
     │   └─ 2026-03-01-main-vs-svelte-run1.md
     ├─ comparisons/                    # Summary / Final results
     │   ├─ main-vs-packages-latest.md
     │   ├─ main-vs-svelte-latest.md
     │   └─ main-vs-reliquary-latest.md
     └─ assets/                         # Screenshots, waterfalls, JSON reports
         ├─ lighthouse/
         │   ├─ main-vs-packages-run1.png
         │   ├─ main-vs-packages-run2.png
         │   └─ main-vs-svelte-run1.png
         └─ webpagetest/
             ├─ main-vs-packages-run1-waterfall.png
             ├─ main-vs-packages-run2-waterfall.png
             └─ main-vs-svelte-run1-waterfall.png
```

## Snapshots

### Naming convention
The ideal way of naming snapshots goes as follows;
```yaml
[date (yyyy-mm-dd)]-[branch 1]-vs-[branch 2]-run[iteration count].md
```

#### Single-branch case:
If testing only one branch with no candidate, omit the “vs” section:
```yaml
[date (yyyy-mm-dd)]-[branch]-run[iteration count].md
```

> [!CAUTION]
> As these are not comparisons; do not include them in the `/comparisons` directory

##### Examples:
```yaml
2026-02-04-main-run1.md
2027-02-05-main-run2.md
2026-10-04-foobar-run1.md
2026-12-04-foobar-run2.md
```

## Comparisons

Comparisons summarize the results of one or more snapshot runs.
They represent the aggregated or averaged metrics for a baseline vs candidate, highlighting improvements or regressions.

#### Naming convention:
[baseline branch/tag]-vs-[candidate branch/tag]-latest.md

##### Examples:
```yaml
main-vs-packages-latest.md
main-vs-svelte-latest.md
main-vs-reliquary-latest.md
```

> [!NOTE]
> Comparisons are updated only after completing all intended snapshot runs for a given baseline/candidate pair.

## Assets
All supporting images, waterfalls, and JSON reports should be stored under the /assets directory and organized by tool:

```yaml
docs/tests/assets/
 ├─ lighthouse/
 └─ webpagetest/
```

### Naming conventions

Asset filenames should clearly identify the test target, run number, and specific type of test or measurement.

This ensures clarity even when multiple types of assets are generated by the same tool (e.g., WebPageTest can generate waterfalls, FCP graphs, etc.)

#### General format
```yaml
[baseline branch]-vs-[candidate branch]-run[iteration]-[asset-type].[extension]
```

#### Single-branch case
omit the `vs-[candidate branch]` section:
```yaml
[branch]-run[iteration]-[asset-type].[extension]
```
### Common asset types
| Asset type            | Example filename (multi-branch)     | Example filename (single-branch) |
| --------------------- | ----------------------------------- | -------------------------------- |
| Lighthouse screenshot | main-vs-packages-run1.png           | main-run1-lighthouse.png                    |
| WebPageTest waterfall | main-vs-packages-run1-waterfall.png | main-run1-waterfall.png          |
| JSON export           | main-vs-packages-run1.json          | main-run1.json                   |

#### Examples (multi-branch)

```yaml
lighthouse/main-vs-packages-run1-screenshot.png
lighthouse/main-vs-packages-run1-lcp.png
webpagetest/main-vs-packages-run1-waterfall.png
webpagetest/main-vs-svelte-run1-fcp.png
```

#### Examples (single-branch)
```yaml
lighthouse/main-run1-screenshot.png
lighthouse/main-run1-lcp.png
webpagetest/main-run1-waterfall.png
webpagetest/main-run1-fcp.png
```

